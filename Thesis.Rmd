---
title: "Thesis"
author: "Paige Stork"
date: "8/31/2022"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Decision Support Tool

## Introduction
* background information on DA flooding and soil conservation
* utility of DSTs and previous work on SMARTScape
* goals of FloodScape
* schematic showing how FloodScape will interface and behind the scenes program

## Methods
As part of the NRCS PLAN-EIS process, a set of hydrologic models were contracted for the two study watersheds. These models were built in the U.S. Army Corps of Engineer's (USACE) program Hydrologic Engineering Center-Hydrologic Modeling System (HEC-HMS) and Hydrologic Engineering Center-River Analysis System (HEC-RAS). Eight storm scenarios were considered; the two-year, five-year, ten-year, 25-year, 50-year, 100-year, 200-year, and 500-year storms. Within HEC-HMS, the Muskingum-Cunge routing method was used, thus channel geometries are reported to HEC-HMS and hydrograph data from a storm simulation may be retrieved directly from HEC-HMS.  This data is output to a .dss file, which may be viewed within the Hydrologic Engineering Center- Data Storage System Visual Utility Engine (HEC-DSSVue) graphical user interface (GUI) or simply extracted via command line prompt. For these set of models, HEC-RAS integrates peak flow data informed by HEC-HMS and computes water surface elevation (WSE) values based on cross sectional geometries. Thus, relationships between peak flow and WSE for each of the eight storms could be developed at each HEC-RAS river station; these relationships are known as rating curves, and once developed, offer a method to calculate WSE given any peak flow at a given HEC-RAS river station (see figure XX-XX). Therefore, utilizing the data extracted from HEC-RAS, new WSE values may be calculated any time a new HEC-HMS simulation is run and peak flow data is extracted. 

The HEC-HMS basin model is made up of several smaller subbasins. Each of these subbasins hold information about the area's size, hydrologic connectivity to other subbasins, and land cover. The key value indicating land cover is runoff curve number (CN), and is the value that may be manipulated to reflect changes to land use. CN is an emperical value first used by the SCS, but now used widely, to predict the approximate amount of direct runoff generated by a rainfall event in a certain area. CN is also used to calculate lag, or the delay between when runoff begins until it reaches its maximum peak. the watershed lag method (part 630 hydrology, national engineering handbook) was used to estimate lag times for each subbasin utilizing the following equation: 

$L = l^{0.8}(S+1)^{0.7}/1,900Y^{0.5}$

where l = flow length (ft),  
      S = maximum potential retention (in) = $1,000/cn -10$  
      Y = average watershed land slope (%)  
      
When the contractors shared their model files, a spreadsheet containing l, S and Y was also supplied. Data was derived from LiDAR contours using CAD and NHD flowlines. 

A .basin file holds CN and Lag data for each subbasin in a basin model. Therefore, to adjust land use within a basin model's subbasins, the .basin file must be manipulated before running a storm scenario. 

Channel and valley cross section geometries were entered into HEC-HMS manually. They were set to the 8 point shape by creating an average cross section for each HMS reach from the corresponding HEC-RAS model sections. These 8 points reflect a 

1. left hillslope point above all flood surfaces 
2. left floodplain/hillslope junction
3. left top of bank
4. left bottom of bank
5. right bottom of bank
6. right top of bank
7. right floodplain/hillslope junction
8. right hillslope point above all flood surfaces

HEC-RAS cross sections, in turn, were pulled from LiDAR data. Topographic LiDAR does not penetrate water to any significant degree and thus some detail within the channel bottom is lost, however this mainly impacts small events in the upper reaches of the watersheds. In lower reaches and larger events, the flow area lost when compared to flow area captured is insignificant. Because the LiDAR survey was focused on PL566 structures, there was insufficient data on water depths to make informed adjustments to the LiDAR data, thus the data was left as-is, and any significant channel capacity lost was addressed during model calibration (email RE: H&H Modeling_CC and WFK).

#### Discussion of model setup
* Reassign .dss file name HMS WFK simulations output to standard set by contractors (typo)
* generally fix typos so that directories and file names follow standard, make code run more effeciently (loops)


Some simplifications to the basin model developed in HEC-HMS were made while developing cross sections for the RAS stream network. The stream network in HEC-RAS begins at the most upstream reach of each network branch. A HMS junction is only included in the RAS network if it brings together multiple reaches; if a junction's only purpose in the HMS model was to signify a subbasin's contribution to the channel, it was not named in the RAS model; instead the reach downstream from this "smoothed over" junction takes on the name of the reach upstream from it, and the change to flow from the contributing subbasin is evident in the change in flow beginning at a key cross section of that "simplified" reach.

![HMS to RAS draft](C:%5CUsers%5Cpaige%5COneDrive%5CDocuments%5CAA_Research%5CThesis%5CFigures%5CHMS_to_RAS_draft.png){width="50%"}

The HMS basin model was inventoried against the RAS stream network, and a list of river stations at which flow is adjusted due to stream branches merging (junction) or to signify the contribution from a subbasin (subbasin) was compiled (TABLE X-X). Wherever a junction or a contributing basin occurs in HMS, a new HMS reach begins. It is these HMS reaches that correlate to changes to flow along the RAS stream network (FIGURE X-X). Therefore, the flow observed in a particular HMS reach correlates to the flow observed between key RAS river stations.

Because the RAS model assumes steady state flow, Q remains constant between these key river stations. But while Q is held constant, the geometry of each cross section between these two key river station changes, and WSE is therefore affected at each cross section. As discrete Q values are adjusted within HMS reaches each time an experimental simulation is run, new WSE values may be calculated at each RAS cross section throughout the full stream network.

![HMS to RAS Q change](C:\Users\paige\OneDrive\Documents\AA_Research\Thesis\Figures\HMS_to_RAS_Qchange_draft.PNG){width="50%"}

Because the RAS model assumes steady state, it is reasonable to consider the most downstream river station the "outlet." However, in the Coon Creek HMS basin model, the subbasin Lower Coon Creek J contributes to the outlet junction. Because no reach exists below the outlet junction and this detail was not adjusted for in the RAS model, Lower Coon Creek J's contribution to the outlet flow does not appear to be represented in the RAS model.

#### Discussion of overall workflow

A schematic of the overall workflow is as follows:

![Visual Workflow draft](C:\Users\paige\OneDrive\Documents\AA_Research\Thesis\Figures\VisualWorkflow_draft.PNG){width="70%"}


### Integrating user input from DST interface

#### Curve Nunbers

#### Lag

#### Stream geometry

### Run HMS
* cite where you found how to structure a .script file

### Obtain time series data from HMS

*   reference HEC-DSSVue Documentation (scripting)
*   reference DSS programmers guide for Java
*   how list of reaches was obtained: open any storm .hms file; open No Dam basin model; parameters > element inventory; show all elements, move element type to first column; click and drag to select everything; right click; Export as text file, include column labels; python processing found in "proofs" .ipynb (List of reaches from No Dams .basin model). The python-generated list of reaches was then manually edited to match how DSS Vue handles element names; namely, while HMS documents element names by capitalizing only acronyms and the first letter of each word, DSS Vue capitalizes everything.  


### Compile necessary results data for DST interface

#### Time series (hydrograph)

#### Peak Flow

#### WSE

To dynamically calculate WSE values at each cross section on the RAS network each time an experimental simulation is run, two things must be done:\
1. rating curves must be calculated at each cross section, such that any peak flow may be correlated with a WSE. These rating curves must only be calculated once, with data from the existing conditions.\
2. Peak flow data at each HMS reach must be extracted each time an experimental simulation is run. These peak flows are applied to each correlated cross sections' rating curve to calculate a new WSE.

![Rating Curve Inclusivity draft](C:%5CUsers%5Cpaige%5COneDrive%5CDocuments%5CAA_Research%5CThesis%5CFigures%5CRatingCurve_Inclusivity_draft.png){width="30%"}

## Results

## Discussion

## Access to tool and code

# NRCS Policy History
* narrow NRCS scope not effective going forward
* alphabet soup of NRCS programs --> how change is incentivized must change

## Acronyms
SCC - Soil Conservation Committee (renamed SWCC in 1967; SCB in 1969; BSWCD in 1972)
CES - Cooperative Extension Service
WCD - Wisconsin Conservation Department
SCS - Soil Conservation Service
NACD - National Association of Conservation Districts
WACD - Wisconsin Association of Conservation Districts
WFBF - Wisconsin Farm Bureau Federation

## State bureaucracy and PL-566
While the 1933 Coon Creek Watershed Demonstration project proved the efficacy of watershed-based conservation efforts, a 1939 revision of Wisconsin Statutes Chapter 92 abolished watershed-based conservation districts. LaCrosse, Vernon, and Monroe Counties established county-wide soil conservation districts on August 17, 1939, November 15, 1939, and November 19, 1940, respectively.  
[find out WHY watershed-based conservation districts were abolished. moved to county-level to make the paperwork easier?] 
>"active interest in the watershed approach to land resource management continued to 'simmer' at the grass roots level, apparently reflecting a widely held belief that the landowners in a watershed and their families represent a distinct 'community of interests,' in sociological jargon. By the early 1950s there was evidence of considerable activity in developing local watershed associations, probably largely motivated by flash flood problems in the west-central and southwestern regions of the state" (Johnson).   

The success of holistic watershed management depends on inter-agency cooperation, and in early 1953, "SCC staff and representatives of cooperating agencies developed a four-agency agreement describing the kinds of assistance that the Conservation Department, Extension Service, SCS and SCC could provide to conservation districts in carrying out local watershed development programs (Johnson). 

Virtually concurrently, on July 28, 1953, the Agricultural Appropriations Act (P.L. 83-156) was passed, funding demonstration projects of combined soil conservation and flood control. The SCS was responsible for selecting pilot watersheds and providing technical assistance to local sponsoring organizations.
Soon after, on August 4, 1954, President Dwight Eisenhower signed the Watershed Protection and Flood Prevention Act (P.L. 83-566), making the watershed program permanent. The SCS was again assigned primary responsibility for administering federal assistance to local sponsors, subject to 

>"the local sponsor's application for such assistance having been approved by 'the State agency having supervisory responsibility over programs provided for in this Act, or by the Governor if there is no state agency having such responsibility'"(Johnson). This sentence, concerning a State agency with supervisory authority, tied Wisconsin agencies up in bureaucratic battles for the duration of the PL-566 program. 

The SCC initially simply asked, in Assembly Bill 422 on February 24, 1955, to be that State agency responsible for supervisory responsibility over PL-566 programs. Other agriculturally based interests, however, saw this provision as an opportunity to restructure Wisconsin's approach to conservation and natural resource management. Wisconsin Farm Bureau Federation's paid lobbyist constructed Assemby Bill 16, which was introduced to the legislature on January 18, 1955. In short, the new agency this bill proposed would exert substantial power over watershed programs and use of federal aid of watershed programs. Going further, a substitute to Assembly Bill 16 was introduced on April 5, proposing to abolish the SCC and make substantial amendments to Chapter 92, to consolidate soil conservation and watershed management in the state Department of Agriculture, and achieve cooperation with the USDA in the administration of federal programs. These proposed features of Assembly Bill 16 signaled a desire for State interests to step between the federal-local arrangements that had become the norm. 

>"Administration of all federal agricultural and conservation benefit programs had by this time become irretrievably entrenched in federal agencies. State governments in their lethargy had long since surrendered the policy-setting prerogatives in exchange for the dubious 'reward' of having these administrative chores handled exclusively through direct federal-local arrangements. That a state legislature might now seriously contemplate asserting a substantive state role in the design and administration of federal programs doling out benefit payments to farmers must have been at least temporarily disconcerting to the federal bureaucracy. Moreover, the idea of establishing the state's soil conservation policy-making and program administration functions in a division of a major department of the executive branch of state government apparently was not yet politically acceptable" (Johnson). 

It is curious that advocates of these bills felt that a strong state supervisory role was necessary to secure federal assistance for PL-566 projects, as a "strong and controlling federal role and a weak and malleable state role were preferred by those who held the key reins of control, namely the 'purse strings'" (Johnson).  
Interestingly, it was a key member of the State's bureaucracy who dealt the sharpest blow to the substitute bill: Professor Henry L. Ahlgren, Assistant Director of Agricultural Extension *and* chairman of the Soil Conservation Committee (two of the four agencies constituting the initial inter-agency cooperation in 1953), said about the bill: "Soil conservation is essentially a farm problem. In my mind there is a serious question as how to be sure that farmers will accept or carry on programs which are planned and administered by non-farmers" (Johnson). This indicated the SCC's inability to appreciate the possibility of a stronger State role in the PL-566 era.  
The SCC and the Wisconsin Farm Bureau Federation finally met and on May 12, 1955 introduced a substitute amendment to Assembly Bill 422, leaving intact the SCC request to be the agency with supervisory responsibility for PL-566 programs. This decision, as well as mainly superficial changes, made up the 1955 amendments to Chapter 92, which was passed and published on June 28, 1955.  
The results of this amendment seems to be that of confusion at both the federal and local level. The SCC became responsible for developing policies and procedures to make effective decisions about PL-566 plans.

>"To federal agency administrators indoctrinated with the line authority concept of organization and desirous of dealing directly with local project sponsors, the imposition of a minor agency of state government having authority to approve, disapprive and coordinate their watershed program probably seemed unreasonable and quite unnecesary" (Johnson). 

To this end, Governor Vernon Thompson wrote letters both to SCC Chairman Ahlgren and to the chief administrator of the SCS in Washington, D.C. affirming that the SCC was indeed the agency that represented the governor responsible for reviewing and approving PL-566 projects, as the 1955 amendments to Chapter 92 had not sufficiently convinced federal agents of the validity of this arrangement (Johnson). 

SCC chairman Ahlgren utilized the template of the four-agency agreement initially organized in 1953 to guide local sponsors seeking assistance under PL-566. Over the PL-566 era, this four-agency agreement grew to nine agencies (the Conservation Department, Extension Service, SCS, SCC, Farmers Home Administration, the ASCS, the Departments of Administration, Agriculture and local Affairs and Development), and various booklets and statements were published at the State level purported to clarify agency responsibilities in local watershed programs. Despite these attempts at clarification and the SCC's aggressive promotion, the PL-566 program struggled with conflicting policies and practices, and lacked sufficient technical and financial assistance. These factors created a logjam of of program applications, and as early as 1956, the SCC was warned that 

>"watershed projects might easily be promoted beyond the capabilities of available manpower and funds to achieve program objectives" (Johnson p 179) 
Given such confusing bureaucratic struggles, it seems a wonder that any attention could be paid to the actual merits of proposed watershed work plans.

By 1960, backlogs of applications existed on both the state and federal level. SCC Chairman Ahlgren seemed hesitant to ask for increases to funding that would allow the SCC to hire a staff of watershed project planners to address the state-level delays. Instead, at the request of the National Association of Conservation Districts (NACD) in 1961, one employee was hired to work for the now Soil and Water Conservation committee (SWCC). The chronic under-resourcing of the program thus continued. An opportunity for an infusion of resources came again in 1967, when the executive branch of Wisconsin state government was reshuffled, and the now Soil Conservation Board's (SCB) relation to the University was adjusted, inspiring the SCB to submit a large budget request for the 1969-1971 biennium. The SCB later learned that the University had removed this budget request from what they presented to the state Legislature. This sparked confusion, and it was discovered that the SCB's "fiscal budgeting, program coordination and related management functions were to be performed under the direction and supervision of the University of Wisconsin-Extension" (Johnson p 182). Interestingly, SCB chairman Henry Ahlgren was also the associate director of Extension (CES).  

The PL-566 program continued to languish through the 1960s and '70s, as watershed projects were marketed to serve ever more purposes, including agricultural water management, known to be another phrase for wetland drainage, and recreation. To this end, the Wisconsin Legislature appropriated hundreds of thousands of dollars over a period of six years (1962-1967) towards a cost-sharing program for recreational lakes, administered through the PL-566 program, by the state agency in charge of *soil conservation*. Throughout the PL-566 era, there seemed, according to written records, to be little attention paid by the SCC to soil erosion, as matters of flood control structures and the transition to multiple purpose developments consumed much of the Committee's resources (Johnson p 194).  

The final breaths of the PL-566 era in Wisconsin were drawn in 1980, when the SCS and DNR formed an agreement to place the program under the state water quality program (Johnson p 204). 

